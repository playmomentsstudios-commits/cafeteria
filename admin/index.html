<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Alfa ‚Ä¢ Card√°pio</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#0b1220;
      --card:#111a2b;
      --card2:#0f1726;
      --line:rgba(255,255,255,.12);
      --text:#f7f7fb;
      --muted:rgba(247,247,251,.7);

      --y:#ffd24a;
      --y2:#ffbb1a;

      --ok:#1dd6a4;
      --danger:#ff5a67;
      --shadow:0 18px 60px rgba(0,0,0,.45);
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 20% 0%, rgba(255,210,74,.18), transparent 55%),
        radial-gradient(900px 600px at 80% 10%, rgba(255,187,26,.14), transparent 55%),
        linear-gradient(180deg, #070b14, var(--bg));
      padding:18px 14px 90px;
    }
    .wrap{max-width:1200px;margin:0 auto}

    .top{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:14px 16px;border-radius:22px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); box-shadow:var(--shadow);
      backdrop-filter: blur(12px);
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .logo{
      width:46px;height:46px;border-radius:16px;overflow:hidden;
      background:rgba(255,255,255,.06);border:1px solid var(--line);
      display:flex;align-items:center;justify-content:center;
    }
    .logo img{width:100%;height:100%;object-fit:cover}
    .brand h1{margin:0;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .brand p{margin:4px 0 0;color:var(--muted);font-size:12px}

    .btn{
      border:none;cursor:pointer;
      padding:10px 12px;border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      color:var(--text);
      font-weight:800;
      display:inline-flex;align-items:center;gap:8px;
    }
    .btn.y{background:linear-gradient(135deg,var(--y),var(--y2)); color:#201400; border-color:rgba(0,0,0,.08)}
    .btn.ghost{background:transparent}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px}
    .card{
      border-radius:22px;padding:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      backdrop-filter: blur(12px);
    }
    .h{margin:0 0 10px;font-size:14px}
    .sub{color:var(--muted);font-size:12px;margin:0 0 12px}

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .field{flex:1;min-width:190px}
    label{display:block;font-size:12px;color:var(--muted);margin:0 0 6px}
    input,select{
      width:100%;
      padding:11px 12px;border-radius:14px;
      background:rgba(0,0,0,.25);
      border:1px solid var(--line);
      color:var(--text);
      outline:none;
    }
    input:focus,select:focus{border-color:rgba(255,210,74,.55)}

    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:14px}
    .tab{
      padding:10px 12px;border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.05);
      color:var(--muted);font-weight:900;
      cursor:pointer;
    }
    .tab.active{background:rgba(255,210,74,.18); color:var(--text); border-color:rgba(255,210,74,.45)}

    .toolbar{
      display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
      margin:12px 0 0;
    }
    .toolbar input{max-width:360px}

    /* GRID 4 */
    .grid4{
      display:grid;
      grid-template-columns:repeat(4,minmax(0,1fr));
      gap:12px;margin-top:12px;
    }
    .item{
      border-radius:18px;padding:12px;
      background:rgba(255,255,255,.05);
      border:1px solid var(--line);
      display:flex;flex-direction:column;gap:10px;
      min-height:160px;
    }
    .itemTop{display:flex;align-items:flex-start;justify-content:space-between;gap:8px}
    .ttl{font-weight:900;line-height:1.15}
    .meta{color:var(--muted);font-size:12px}
    .pill{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 9px;border-radius:999px;
      font-weight:900;font-size:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
    }
    .pill.ok{background:rgba(29,214,164,.14); border-color:rgba(29,214,164,.35)}
    .pill.off{opacity:.65}
    .menuWrap{position:relative}
    .kebab{
      width:38px;height:38px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      cursor:pointer;
      font-weight:900;
    }
    .menu{
      position:absolute;right:0;top:44px;z-index:20;
      min-width:180px;
      border-radius:14px;
      border:1px solid var(--line);
      background:#0b1220;
      box-shadow:0 20px 60px rgba(0,0,0,.55);
      overflow:hidden;
      display:none;
    }
    .menu button{
      width:100%;
      text-align:left;
      padding:10px 12px;
      border:none;
      background:transparent;
      color:var(--text);
      cursor:pointer;
      font-weight:800;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .menu button:hover{background:rgba(255,255,255,.06)}
    .menu button.danger{color:#ff7b86}

    .msg{
      margin-top:12px;padding:12px;border-radius:14px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.20);
      color:var(--muted);
      font-size:13px;
    }
    .msg.err{border-color:rgba(255,90,103,.45); color:#ffd0d5}
    .msg.ok{border-color:rgba(29,214,164,.40); color:#c9fff0}

    /* LOGIN SCREEN */
    .loginFull{
      min-height: calc(100vh - 36px);
      display:flex;align-items:center;justify-content:center;
    }
    .loginCard{
      width:min(420px,100%);
      border-radius:24px;
      padding:20px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      backdrop-filter: blur(12px);
      text-align:center;
    }
    .loginLogo{
      width:64px;height:64px;border-radius:20px;
      margin:0 auto 12px;
      overflow:hidden;border:1px solid var(--line);
      background:rgba(255,255,255,.06);
    }
    .loginLogo img{width:100%;height:100%;object-fit:cover}
    .loginCard h2{margin:8px 0 0}
    .loginCard p{margin:6px 0 14px;color:var(--muted);font-size:13px}

    @media (max-width:1050px){ .grid4{grid-template-columns:repeat(2,minmax(0,1fr))} }
    @media (max-width:720px){
      .grid2{grid-template-columns:1fr}
      .grid4{grid-template-columns:1fr}
    }
  
/* Cadastros list */
#cad-list{display:flex;flex-direction:column;gap:10px;margin-top:12px}
.cad-row{display:flex;gap:12px;justify-content:space-between;align-items:flex-start;padding:12px;border:1px solid rgba(255,255,255,.08);border-radius:12px;background:rgba(0,0,0,.18)}
.cad-title{display:flex;gap:10px;align-items:center;margin-bottom:6px}
.cad-meta,.cad-small{display:flex;flex-wrap:wrap;gap:8px;opacity:.9;font-size:13px}
.cad-desc{margin-top:8px;font-size:13px;opacity:.95}
.dot{opacity:.6}
.badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.15)}
.badge.ok{background:rgba(46,204,113,.18)}
.badge.warn{background:rgba(241,196,15,.18)}
.badge.bad{background:rgba(231,76,60,.18)}
.btn.small{padding:8px 10px;font-size:13px;border-radius:10px}
.btn.ok{background:#2ecc71;color:#0b0f0e}
.btn.bad{background:#e74c3c;color:#fff}
.link{color:#f1c40f;text-decoration:none}
.err{color:#ff6b6b}
.muted{opacity:.75}


/* === Login (slim) === */
.loginWrap{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;padding:28px}
.loginHeroLogo img{width:120px;max-width:60vw;height:auto;display:block;filter:drop-shadow(0 10px 25px rgba(0,0,0,.35))}
.loginCard{width:min(420px,92vw);background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.10);border-radius:18px;padding:18px 18px 16px;backdrop-filter: blur(10px)}
.loginForm{margin-top:10px;text-align:left}
.sp10{height:10px}
.loginActions{justify-content:center;margin-top:14px;gap:10px}
.btn.gIcon{width:44px;min-width:44px;height:40px;padding:0;border-radius:12px;display:flex;align-items:center;justify-content:center}
.gMark{font-weight:900;font-size:18px;line-height:1;letter-spacing:-1px}

</style>
</head>

<body>
<div class="wrap" id="app" style="display:none">

  <div class="top">
    <div class="brand">
      <div class="logo"><img src="../logo.png" onerror="this.style.display='none';this.parentElement.textContent='ADM'"></div>
      <div style="min-width:0">
        <h1>Admin Alfa</h1>
        <p>Gerencie clientes, categorias e produtos.</p>
      </div>
    </div>
    <div class="row">
      <button class="btn ghost" id="btnReload">üîÑ Recarregar</button>
      <button class="btn y" id="btnSair">üö™ Sair</button>
    </div>
  </div>

  <div class="tabs">
    <button class="tab active" data-tab="clientes">Clientes</button>
    <button class="tab" data-tab="categorias">Categorias</button>
    <button class="tab" data-tab="produtos">Produtos</button>
    <button class="tab" data-tab="cadastros">Cadastros</button>
  </div>

  <div class="grid2">
    <div class="card">
      <h3 class="h">Criar Cliente</h3>
      <p class="sub">Cria a loja + (opcional) cria login do cliente no Supabase Auth.</p>

      <div class="row">
        <div class="field">
          <label>Nome</label>
          <input id="c_nome" placeholder="Ex: Padaria do Z√©" />
        </div>
        <div class="field">
          <label>Slug</label>
          <input id="c_slug" placeholder="ex: padaria-do-ze" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>WhatsApp</label>
          <input id="c_whats" placeholder="6299..." />
        </div>
        <div class="field">
          <label>Tipo de neg√≥cio</label>
          <select id="c_tipo">
            <option value="">Selecione‚Ä¶</option>
            <option>Restaurante</option>
            <option>Mercado</option>
            <option>Padaria</option>
            <option>Lanchonete</option>
            <option>Farm√°cia</option>
            <option>Petshop</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Logo URL (opcional)</label>
          <input id="c_logo" placeholder="https://.../logo.png" />
        </div>
        <div class="field">
          <label>Status</label>
          <select id="c_ativo">
            <option value="true">Ativo</option>
            <option value="false">Inativo</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Email do cliente (opcional)</label>
          <input id="c_email" placeholder="cliente@dominio.com" />
        </div>
        <div class="field">
          <label>Senha do cliente (opcional)</label>
          <input id="c_senha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <button class="btn y" id="btnCriarCliente">‚ûï Criar cliente</button>
      </div>

      <div id="msg" class="msg" style="display:none"></div>
    </div>

    <div class="card">
      <h3 class="h">Cadastros</h3>
      <p class="sub">Selecione um cliente e cadastre categorias/produtos com seguran√ßa.</p>

      <div class="row">
        <div class="field">
          <label>Cliente selecionado</label>
          <select id="selCliente"></select>
        </div>
        <div class="field">
          <label>Categoria (para produto)</label>
          <select id="selCategoria"></select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Nova categoria</label>
          <input id="cat_nome" placeholder="Ex: Bebidas" />
        </div>
        <div class="field">
          <label>Ordem</label>
          <input id="cat_ordem" type="number" value="0" />
        </div>
      </div>

      <div class="row">
        <button class="btn y" id="btnCriarCategoria">üìÅ Criar categoria</button>
      </div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,.08);margin:14px 0">

      <div class="row">
        <div class="field">
          <label>Produto</label>
          <input id="p_nome" placeholder="Ex: P√£o de queijo" />
        </div>
        <div class="field">
          <label>Pre√ßo</label>
          <input id="p_preco" type="number" step="0.01" value="0" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Descri√ß√£o</label>
          <input id="p_desc" placeholder="opcional..." />
        </div>
        <div class="field">
          <label>Imagem URL (opcional)</label>
          <input id="p_img" placeholder="https://.../foto.jpg" />
        </div>
      </div>

      <div class="row">
        <button class="btn y" id="btnCriarProduto">üßæ Criar produto</button>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:14px">
    <div class="toolbar">
      <div>
        <h3 class="h" id="listTitle">Clientes</h3>
        <p class="sub" id="listSub">Grid 4 colunas</p>
      </div>
      <input id="search" placeholder="Buscar..." / id="cad-search">
    </div>
    <div class="grid4" id="list"></div>
  </div>

</div>

<!-- LOGIN -->
<div class="loginFull" id="login">
  <div class="loginCard">
    <div class="loginLogo"><img src="../logo.png" onerror="this.style.display='none';this.parentElement.textContent='ADM'"></div>
    <h2>Entrar</h2>
    <p>Email/senha do Supabase Auth ou Google.</p>

    <div style="text-align:left;margin-top:10px">
      <label>Email</label>
      <input id="email" placeholder="seu@email.com" />
      <div style="height:10px"></div>
      <label>Senha</label>
      <input id="senha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
    </div>

    <div class="row" style="justify-content:center;margin-top:14px">
      <button class="btn y" id="btnLogin">üîí Entrar</button>
      <button class="btn" id="btnGoogle">üü¶ Entrar com Google</button>
    </div>

    <div id="loginMsg" class="msg err" style="display:none;margin-top:12px"></div>
  </div>
</div>

<script>
  // ====== CONFIG ======
  const SUPABASE_URL = "https://rgsnmxspyywwouhcdwkj.supabase.co";
  const SUPABASE_ANON_KEY = "sb_publishable_nHPsCV3y79FgexEMAeANWQ_P6jWRDd1";
  const API_BASE = "https://cafeteria-gamma-orpin.vercel.app/api/admin";

    const ALFA_EMAIL = "playmomentsstudios@gmail.com";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // ====== STATE ======
  let session = null;
  let tab = "clientes";
  let clientes = [];
  let categorias = [];
  let produtos = [];
  let cadastros = [];
  let cadastroAtivo = true;

  // ====== UI HELPERS ======
  const el = (id)=>document.getElementById(id);
  const show = (id)=>el(id).style.display="block";
  const hide = (id)=>el(id).style.display="none";

  function msg(text, type=""){
    const box = el("msg");
    box.style.display = "block";
    box.className = "msg " + (type||"");
    box.textContent = text;
    setTimeout(()=>{ box.style.display="none"; }, 4000);
  }
  function loginMsg(text){
    const box = el("loginMsg");
    box.style.display = "block";
    box.textContent = text;
  }

  // ====== AUTH GUARD (somente Admin Alfa) ======
  function isAlfa(){
    const email = session?.user?.email || "";
    return String(email).toLowerCase() === "playmomentsstudios@gmail.com".toLowerCase();
  }

  async function requireAlfa(){
    if (!session) return false;
    if (isAlfa()) return true;

    // bloqueia qualquer usu√°rio que n√£o seja o alfa
    try{ await sb.auth.signOut(); }catch(_e){}
    session = null;
    el("app").style.display = "none";
    show("login");
    loginMsg("Acesso negado: este painel √© apenas para o Admin Alfa.");
    return false;
  }

  function slugify(s){
    return String(s||"")
      .toLowerCase()
      .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/(^-|-$)+/g, "");
  }

  function money(v){
    return Number(v||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
  }

  function openMenu(id){
    document.querySelectorAll(".menu").forEach(m=>m.style.display="none");
    const m = document.getElementById(id);
    if (m) m.style.display = "block";
  }
  window.addEventListener("click", (e)=>{
    if (!e.target.closest(".menuWrap")) document.querySelectorAll(".menu").forEach(m=>m.style.display="none");
  });

  // ====== API CALL ======
  async function api(path, method="GET", body=null){
    const token = session?.access_token;
    const headers = {
      "Content-Type":"application/json",
      "Authorization": "Bearer " + token
    };
    const opts = { method, headers };
    if (body) opts.body = JSON.stringify(body);

    const r = await fetch(API_BASE + path, opts);
    const j = await r.json().catch(()=> ({}));
    if (!r.ok) throw new Error(j.error || ("HTTP " + r.status));
    return j;
  }


  // ====== CADASTRO P√öBLICO (Landing Page) ======
  async function loadCadastroConfig(){
    const { data, error } = await sb
      .from("portal_config")
      .select("chave, valor")
      .eq("chave","cadastro_publico_ativo")
      .single();

    if (error){
      // Se ainda n√£o existe registro, assume ativo (e o Admin pode criar pelo toggle)
      cadastroAtivo = true;
      return;
    }
    cadastroAtivo = String(data?.valor||"true") === "true";
  }

  async function setCadastroAtivo(v){
    const { error } = await sb
      .from("portal_config")
      .upsert({ chave:"cadastro_publico_ativo", valor: v ? "true" : "false" }, { onConflict:"chave" });
    if (error) throw error;
    cadastroAtivo = !!v;
  }

  async function loadCadastros(){
    const { data, error } = await sb
      .from("cadastros_clientes")
      .select("*")
      .order("created_at",{ascending:false});
    if (error){
      cadastros = [];
      return;
    }
    cadastros = data || [];
  }

  function pendentesCount(){
    return cadastros.filter(x => String(x.status||"pendente")==="pendente").length;
  }

  async function alternarCadastroPublico(){
    const novo = !cadastroAtivo;
    await setCadastroAtivo(novo);
    renderList();
    msg("Cadastro p√∫blico " + (novo ? "ATIVADO" : "DESATIVADO") + " ‚úÖ", "ok");
  }

  async function aprovarCadastro(id){
  try{
    const { data: cad, error } = await sb.from("cadastros_clientes").select("*").eq("id", id).single();
    if(error) throw error;

    const base = (cad.nome_negocio || "negocio").toLowerCase()
      .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
      .replace(/[^a-z0-9\s-]/g,"")
      .trim().replace(/\s+/g,"-").replace(/-+/g,"-")
      .slice(0, 40) || "negocio";
    let slug = base;

    const { data: exists } = await sb.from("clientes").select("slug").eq("slug", slug).maybeSingle();
    if(exists?.slug){
      slug = `${base}-${String(Date.now()).slice(-4)}`;
    }

    const payload = {
      nome: cad.nome_negocio,
      slug,
      whatsapp: cad.whatsapp || "",
      ativo: true,
      tipo: "portal",
      tipo_negocio: (cad.categoria || "comercio").toLowerCase()
    };

    const { error: cErr } = await sb.from("clientes").insert(payload);
    if(cErr) throw cErr;

    const { error: uErr } = await sb.from("cadastros_clientes")
      .update({ status: "aprovado", cliente_slug: slug, aprovado_em: new Date().toISOString() })
      .eq("id", id);
    if(uErr) throw uErr;

    toastOk("Cadastro aprovado e cliente criado!");
    loadCadastros();
    if(typeof loadClientes === "function") loadClientes();
  }catch(e){
    toastErr("Falha ao aprovar: " + (e?.message || e));
  }
}

function renderCadastroRow(r){
  const st = (r.status || "pendente").toLowerCase();
  const badge =
    st === "pendente" ? `<span class="badge warn">Pendente</span>` :
    st === "aprovado" ? `<span class="badge ok">Aprovado</span>` :
    `<span class="badge bad">Rejeitado</span>`;

  const when = r.created_at ? new Date(r.created_at).toLocaleString() : "";
  const wpp = (r.whatsapp || "").replace(/\D/g,"");
  const wppLink = wpp ? `<a href="https://wa.me/${wpp}" target="_blank" rel="noreferrer" class="link">WhatsApp</a>` : "";

  return `
    <div class="cad-row" id="cad-row-${r.id}">
      <div class="cad-main">
        <div class="cad-title">
          <strong>${escapeHtml(r.nome_negocio || "‚Äî")}</strong>
          ${badge}
        </div>
        <div class="cad-meta">
          <span>${escapeHtml(r.cidade || "‚Äî")}</span>
          <span class="dot">‚Ä¢</span>
          <span>${escapeHtml(r.categoria || "‚Äî")}</span>
          <span class="dot">‚Ä¢</span>
          <span>${escapeHtml(r.whatsapp || "‚Äî")}</span>
          ${wppLink ? `<span class="dot">‚Ä¢</span>${wppLink}` : ``}
        </div>
        <div class="cad-small">
          <span>${when}</span>
          ${r.email ? `<span class="dot">‚Ä¢</span><span>${escapeHtml(r.email)}</span>` : ``}
          ${r.instagram ? `<span class="dot">‚Ä¢</span><span>@${escapeHtml(r.instagram)}</span>` : ``}
        </div>
        ${r.endereco ? `<div class="cad-desc"><strong>Endere√ßo:</strong> ${escapeHtml(r.endereco)}</div>` : ``}
        ${r.mensagem ? `<div class="cad-desc"><strong>Mensagem:</strong> ${escapeHtml(r.mensagem)}</div>` : ``}
      </div>

      <div class="cad-actions">
        ${
          st === "pendente"
            ? `
              <button class="btn small ok" id="cad-aprovar-${r.id}">Aprovar</button>
              <button class="btn small bad" id="cad-rejeitar-${r.id}">Rejeitar</button>
            `
            : `<button class="btn small" id="cad-detalhes-${r.id}">Detalhes</button>`
        }
      </div>
    </div>
  `;
}

function bindCadastroActions(id){
  const ap = document.getElementById(`cad-aprovar-${id}`);
  const rj = document.getElementById(`cad-rejeitar-${id}`);
  const dt = document.getElementById(`cad-detalhes-${id}`);

  if(ap) ap.onclick = () => aprovarCadastro(id);
  if(rj) rj.onclick = () => rejeitarCadastro(id);
  if(dt) dt.onclick = async () => {
    const { data } = await sb.from("cadastros_clientes").select("*").eq("id", id).single();
    alert(JSON.stringify(data || {}, null, 2));
  };
}

async function rejeitarCadastro(id){
  try{
    const { error } = await sb.from("cadastros_clientes")
      .update({ status: "rejeitado", rejeitado_em: new Date().toISOString() })
      .eq("id", id);
    if(error) throw error;

    toastOk("Cadastro rejeitado.");
    loadCadastros();
  }catch(e){
    toastErr("Falha ao rejeitar: " + (e?.message || e));
  }
}

</script>

<script id="cad-search-listener">
document.addEventListener("input", (e)=>{
  if(e?.target?.id === "cad-search"){
    try{ loadCadastros(); }catch(_){}
  }
});
</script>
</body>
</html>